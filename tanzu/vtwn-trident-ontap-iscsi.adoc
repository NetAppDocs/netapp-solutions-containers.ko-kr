---
sidebar: sidebar 
permalink: tanzu/vtwn-trident-ontap-iscsi.html 
keywords: Trident, Trident, ONTAP, AFF, FAS, iSCSI, Tanzu, TKG, TKGS, TKGI 
summary: iSCSI를 통해 NetApp ONTAP 스토리지 시스템을 VMware Tanzu Kubernetes 클러스터와 영구 볼륨에 통합하려면 첫 번째 단계는 각 노드에 로그인하고 iSCSI 유틸리티나 패키지를 구성하여 iSCSI 볼륨을 마운트하여 노드를 준비하는 것입니다. 
---
= NetApp ONTAP iSCSI 구성
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
iSCSI를 통해 NetApp ONTAP 스토리지 시스템을 VMware Tanzu Kubernetes 클러스터와 영구 볼륨에 통합하려면 첫 번째 단계로 각 노드에 로그인하고 iSCSI 유틸리티나 패키지를 구성하여 iSCSI 볼륨을 마운트하여 노드를 준비해야 합니다.  그렇게 하려면 여기에 명시된 절차를 따르십시오.link:https://docs.netapp.com/us-en/trident/trident-use/worker-node-prep.html#iscsi-volumes["링크"^] .


NOTE: NetApp VMware Tanzu Kubernetes 클러스터의 NAT 배포에 대해 이 절차를 권장하지 않습니다.


NOTE: TKGI는 변경 불가능한 구성 이미지를 실행하는 Tanzu Kubernetes 클러스터의 노드로 Bosh VM을 사용하며, Bosh VM에서 iSCSI 패키지를 수동으로 변경한 내용은 재부팅 시 영구적으로 유지되지 않습니다.  따라서 NetApp TKGI에서 배포하고 운영하는 Tanzu Kubernetes 클러스터의 영구 저장소로 NFS 볼륨을 사용할 것을 권장합니다.

클러스터 노드가 iSCSI 볼륨에 대해 준비되면 스토리지 시스템과 통신할 수 있는 백엔드를 만들어야 합니다.  이 솔루션에서는 기본 백엔드를 구성했지만, 더욱 맞춤화된 옵션을 찾고 있다면 설명서를 방문하세요.link:https://docs.netapp.com/us-en/trident/trident-use/ontap-san.html["여기"^] .



== ONTAP 에서 SVM 만들기

ONTAP 에서 SVM을 생성하려면 다음 단계를 완료하세요.

. ONTAP 시스템 관리자에 로그인하고 스토리지 > 스토리지 VM으로 이동한 다음 추가를 클릭합니다.
. SVM의 이름을 입력하고 iSCSI 프로토콜을 활성화한 다음 데이터 LIF에 대한 세부 정보를 제공합니다.
+
image:vtwn-025.png["iSCSI SVM 데이터 LIF"]

. SVM 관리 계정에 대한 세부 정보를 입력한 다음 저장을 클릭합니다.
+
image:vtwn-026.png["iSCSI SVM 관리"]

. SVM에 집계를 할당하려면 저장소 > 저장소 VM으로 이동한 다음 새로 만든 SVM 옆에 있는 줄임표를 클릭하고 편집을 클릭합니다.  '선호하는 로컬 계층에 대한 볼륨 생성 제한' 확인란을 선택하고 필요한 집계를 첨부합니다.
+
image:vtwn-027.png["SVM 집계 할당"]





== 백엔드 및 StorageClass 생성

. NFS를 제공하는 NetApp ONTAP 시스템의 경우, backendName, managementLIF, dataLIF, svm, 사용자 이름, 비밀번호 및 기타 세부 정보가 포함된 백엔드 구성 파일을 점프 호스트에 만듭니다.
+
[listing]
----
{
  "version": 1,
  "storageDriverName": "ontap-san",
  "backendName": "ontap-san+10.61.181.231",
  "managementLIF": "172.21.224.201",
  "dataLIF": "10.61.181.231",
  "svm": "trident_svm_iscsi",
  "username": "admin",
  "password": "password"
}
----
. 다음 명령을 실행하여 Trident 백엔드를 만듭니다.
+
[listing]
----
[netapp-user@rhel7 trident-installer]$ ./tridentctl -n trident create backend -f backend-ontap-san.json
+------------------------+----------------+--------------------------------------+--------+---------+
|          NAME          | STORAGE DRIVER |                 UUID                 | STATE  | VOLUMES |
+------------------------+----------------+--------------------------------------+--------+---------+
| ontap-san+10.61.181.231 | ontap-san      | 6788533c-7fea-4a35-b797-fb9bb3322b91 | online |       0 |
+------------------------+----------------+--------------------------------------+--------+---------+
----
. 백엔드를 만든 후에는 스토리지 클래스를 만들어야 합니다.  다음 샘플 저장 클래스 정의는 필수 필드와 기본 필드를 강조해서 보여줍니다.  매개변수 `backendType` 새로 생성된 Trident 백엔드의 스토리지 드라이버를 반영해야 합니다.  또한, 이후 단계에서 참조해야 하는 이름 필드 값도 기록해 둡니다.
+
[listing]
----
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: ontap-iscsi
provisioner: csi.trident.netapp.io
parameters:
  backendType: "ontap-san"
----
+

NOTE: 라는 선택적 필드가 있습니다. `fsType` 이 파일에 정의되어 있습니다.  iSCSI 백엔드에서 이 값은 특정 Linux 파일 시스템 유형(XFS, ext4 등)으로 설정하거나 삭제하여 Tanzu Kubernetes 클러스터가 사용할 파일 시스템을 결정하도록 할 수 있습니다.

. kubectl 명령을 실행하여 스토리지 클래스를 생성합니다.
+
[listing]
----
[netapp-user@rhel7 trident-installer]$ kubectl create -f storage-class-iscsi.yaml
storageclass.storage.k8s.io/ontap-iscsi created
----
. 스토리지 클래스가 생성되면 첫 번째 영구 볼륨 클레임(PVC)을 생성해야 합니다.  PVC 정의의 예는 아래와 같습니다.  다음 사항을 확인하세요. `storageClassName` 필드는 방금 만든 저장소 클래스의 이름과 일치합니다.  PVC 정의는 프로비저닝할 작업 부하에 따라 필요에 따라 추가로 사용자 정의할 수 있습니다.
+
[listing]
----
kind: PersistentVolumeClaim
apiVersion: v1
metadata:
  name: basic
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
  storageClassName: ontap-iscsi
----
. kubectl 명령을 실행하여 PVC를 생성합니다.  생성되는 백업 볼륨의 크기에 따라 생성에 시간이 걸릴 수 있으므로, 프로세스가 완료되는 모습을 지켜볼 수 있습니다.
+
[listing]
----
[netapp-user@rhel7 trident-installer]$ kubectl create -f pvc-basic.yaml
persistentvolumeclaim/basic created

[netapp-user@rhel7 trident-installer]$ kubectl get pvc
NAME    STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
basic   Bound    pvc-7ceac1ba-0189-43c7-8f98-094719f7956c   1Gi        RWO            ontap-iscsi      3s
----

